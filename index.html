<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>AI Th·ªùi ti·∫øt</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #74ebd5, #ACB6E5);
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      padding: 1rem; /* Th√™m padding ƒë·ªÉ tr√°nh container ch·∫°m vi·ªÅn tr√™n mobile */
    }
    .container {
      background-color: white;
      padding: 2rem;
      border-radius: 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
      width: 100%;
      max-width: 400px;
      text-align: center;
    }
    h2 {
      margin-top: 0; /* B·ªè margin top m·∫∑c ƒë·ªãnh c·ªßa h2 */
      margin-bottom: 1.5rem; /* TƒÉng kho·∫£ng c√°ch d∆∞·ªõi h2 */
      color: #333;
    }
    input[type="text"] { /* C·ª• th·ªÉ h∆°n cho input text */
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #ccc;
      border-radius: 8px;
      margin-bottom: 1rem;
      font-size: 1rem;
      transition: border-color 0.3s, box-shadow 0.3s; /* Th√™m transition cho box-shadow */
    }
    input[type="text"]:focus {
      border-color: #0077ff;
      box-shadow: 0 0 0 0.2rem rgba(0,123,255,.25); /* Th√™m hi·ªáu ·ª©ng focus */
      outline: none;
    }
    button {
      padding: 0.75rem 1.5rem;
      background-color: #0077ff;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      transition: background-color 0.3s; /* S·ª≠a l·∫°i transition property */
    }
    button:hover {
      background-color: #005fcc;
    }
    button:disabled { /* Style cho n√∫t khi b·ªã v√¥ hi·ªáu h√≥a */
        background-color: #cccccc;
        cursor: not-allowed;
    }
    #response {
      margin-top: 1.5rem; /* TƒÉng kho·∫£ng c√°ch tr√™n response */
      font-size: 1.05rem; /* ƒêi·ªÅu ch·ªânh font size */
      color: #444;
      min-height: 2em; /* ƒê·∫£m b·∫£o c√≥ kh√¥ng gian cho text, tr√°nh nh·∫£y layout */
      line-height: 1.6; /* C·∫£i thi·ªán kh·∫£ nƒÉng ƒë·ªçc */
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>üå§Ô∏è AI Tra C·ª©u Th·ªùi Ti·∫øt</h2>
    <input type="text" id="questionInput" placeholder="H·ªèi th·ªùi ti·∫øt (v√≠ d·ª•: H√† N·ªôi) ...">
    <button onclick="askWeather()">Xem th·ªùi ti·∫øt</button>
    <p id="response"></p>
  </div>

  <script>
    const questionInputElement = document.getElementById("questionInput");
    const responseElement = document.getElementById("response");
    const submitButton = document.querySelector("button");

    async function askWeather() {
      const question = questionInputElement.value.trim();

      if (!question) {
        responseElement.innerText = "Vui l√≤ng nh·∫≠p t√™n th√†nh ph·ªë ho·∫∑c c√¢u h·ªèi v·ªÅ th·ªùi ti·∫øt.";
        return;
      }

      // Tr·∫°ng th√°i ch·ªù
      responseElement.innerText = "ƒêang t√¨m ki·∫øm th√¥ng tin...";
      submitButton.disabled = true;
      questionInputElement.disabled = true;

      try {
        const encodedQuestion = encodeURIComponent(question);
        const res = await fetch(`http://localhost:8000/ask?question=${encodedQuestion}`);
        
        // Kh√¥ng c·∫ßn ki·ªÉm tra res.ok ·ªü ƒë√¢y v√¨ backend s·∫Ω lu√¥n tr·∫£ v·ªÅ JSON
        // (tr·ª´ tr∆∞·ªùng h·ª£p server FastAPI b·ªã s·∫≠p ho√†n to√†n ho·∫∑c l·ªói CORS nghi√™m tr·ªçng)
        const data = await res.json();

        if (data && data.message) {
            responseElement.innerText = data.message;
        } else {
            // Tr∆∞·ªùng h·ª£p backend tr·∫£ v·ªÅ c·∫•u tr√∫c kh√¥ng mong ƒë·ª£i
            responseElement.innerText = "ƒê√£ c√≥ l·ªói x·∫£y ra. Ph·∫£n h·ªìi kh√¥ng h·ª£p l·ªá t·ª´ m√°y ch·ªß.";
        }

      } catch (error) {
        console.error("L·ªói khi g·ªçi API:", error);
        responseElement.innerText = "Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn m√°y ch·ªß ho·∫∑c ƒë√£ c√≥ l·ªói x·∫£y ra. Vui l√≤ng th·ª≠ l·∫°i.";
      } finally {
        // Kh√¥i ph·ª•c tr·∫°ng th√°i
        submitButton.disabled = false;
        questionInputElement.disabled = false;
      }
    }

    // Cho ph√©p nh·∫•n Enter ƒë·ªÉ g·ª≠i
    questionInputElement.addEventListener("keypress", function(event) {
        if (event.key === "Enter") {
            event.preventDefault(); // NgƒÉn h√†nh vi m·∫∑c ƒë·ªãnh c·ªßa Enter (n·∫øu c√≥ form)
            askWeather();
        }
    });
  </script>
</body>
</html>